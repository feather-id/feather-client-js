const utils = require("../lib/utils");
const nock = require("nock");

const testUtils = {
  /**
   * Get a Feather API key for testing
   */
  getFeatherApiKey: function() {
    const key =
      process.env.FEATHER_TEST_API_KEY || "test_laCZGYfaDReNmwklZsfIrTsFa5nVh9";
    return key;
  },

  /**
   *
   */
  getSampleSessionTokens: function() {
    return {
      validButStale: `eyJhbGciOiJSUzI1NiIsImtpZCI6IjAiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJQUkpfY2RiY2M5ODYtYWU2Ni00NjY2LWI5NDYtMTgyNmNmMGIyYjU3IiwiY2F0IjoxNTg5Mzc3Mzk0LCJleHAiOjE1ODkzNzc5OTQsImlhdCI6MTU4OTM3NzM5NCwiaXNzIjoiZmVhdGhlci5pZCIsImp0aSI6IlVDc3pybnFTeGhzNkZmeDUwdFp6ZHVwTmpsWmZQM1VrZzI3VUZvVHhReVlwa0hZN2VtMFZndEtSTDNQempReXpia3JoNGVONDl0WlRTS1dJaVowN05UQlJoSHY1Y25JeXNPSzciLCJyYXQiOm51bGwsInNlcyI6IlNFU18xMDgzNmNiNi05OTRkLTQwZjYtOTUwYy0zNjE3YmUxN2I3YzMiLCJzdWIiOiJVU1JfYTY4NzViMzQtNDZlYS00MjlkLTg1OGMtM2FhNmEzNDNiNTM0IiwidHlwIjoiYXV0aGVudGljYXRlZCJ9.wgXjg4eY6ziujbGpOuwFyNB9hQrQSFd98Ey4gMhVarZK3OmdXbB0QqDahg1ON6Ebzr_oydjTyk1yD-eJ-5Rf5YwIvl7tC9fTPDkH2rYSIH6qfi0a5k-8-Km8E4x7TY4YPybdMmA4ycJUXvyPEl7N2awHb1YduCpDptUR9A2y_ASzyK4Lw01EdazEjho0OW2sJ7BjInirRbLuK1dKvrUicI8Sj-glr9WRlD1XF0zBeOTcwIa7sMieBrkCUtzPb1QWWTXbExmtGyDr0lyGX_dXdZGO_Q53PRI7m01HxNzrCf1GF_zXoKogg6iQnpbXopSTp51hwe5m-QYBPd0IT2YTsw`,

      invalidAlg: `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJQUkpfY2RiY2M5ODYtYWU2Ni00NjY2LWI5NDYtMTgyNmNmMGIyYjU3IiwiY2F0IjoxNTg5MzgzMzUwLCJleHAiOjE1ODkzODM5NTAsImlhdCI6MTU4OTM4MzM1MCwiaXNzIjoiZmVhdGhlci5pZCIsImp0aSI6IndqWEl0UDVrT29RR1EwekppUEp5NU4zenhuRjM1MjBBTk1CT0E4eEM2dklwMWN2S2o0TGpYOXdBN1VnckZiWkNHcWJzRzJLV21hZVNWaGs1aVlMTlRKTUw3YnQ4eGxTSWJ2Y3MiLCJyYXQiOm51bGwsInNlcyI6IlNFU184ZGZkYzJmOC05MWY1LTRlOTUtYTI2OC03ODU0MDk4YzI2ZmUiLCJzdWIiOiJVU1JfYTY4NzViMzQtNDZlYS00MjlkLTg1OGMtM2FhNmEzNDNiNTM0IiwidHlwIjoiYXV0aGVudGljYXRlZCJ9.xwBv15XVY6TZWJDNoMkyJG7OwCRRwpPF1Yv3p1_bEpk`,

      invalidSignature: `eyJhbGciOiJSUzI1NiIsImtpZCI6IjAiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJQUkpfY2RiY2M5ODYtYWU2Ni00NjY2LWI5NDYtMTgyNmNmMGIyYjU3IiwiY2F0IjoxNTg5Mzc3Mzk0LCJleHAiOjE1ODkzNzc5OTQsImlhdCI6MTU4OTM3NzM5NCwiaXNzIjoiZmVhdGhlci5pZCIsImp0aSI6IlVDc3pybnFTeGhzNkZmeDUwdFp6ZHVwTmpsWmZQM1VrZzI3VUZvVHhReVlwa0hZN2VtMFZndEtSTDNQempReXpia3JoNGVONDl0WlRTS1dJaVowN05UQlJoSHY1Y25JeXNPSzciLCJyYXQiOm51bGwsInNlcyI6IlNFU18xMDgzNmNiNi05OTRkLTQwZjYtOTUwYy0zNjE3YmUxN2I3YzMiLCJzdWIiOiJVU1JfYTY4NzViMzQtNDZlYS00MjlkLTg1OGMtM2FhNmEzNDNiNTM0IiwidHlwIjoiYXV0aGVudGljYXRlZCJ9.wgXjg4eY6ziujbGpOuwFyNB9hQrQSFd98Ey4gMhVarZK3OmdXbB0QqDahg1ON6Ebzr_oydjTyk1yD-eJ-5Rf5YwIvl7tC9fTPDkH2rYSIH6qfi0a5k-8-Km8E4x7TY4YPybdMmA4ycJUXvyPEl7N2awHb1YduCpDptUR9A2y_ASzyK4Lw01EdazEjho0OW2sJ7BjInirRbLuK1dKvrUicI8Sj-glr9WRlD1XF0zBeOTcwIa7sMieBrkCUtzPb1QWWTXbExmtGyDr0lyGX_dXdZGO_Q53PRI7m01HxNzrCf1GF_zXoKogg6iQnpbXopSTp51hwe5m-QYBPd0IT2YTs`,

      modified: `fyJhbGciOiJSUzI1NiIsImtpZCI6IjAiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJQUkpfY2RiY2M5ODYtYWU2Ni00NjY2LWI5NDYtMTgyNmNmMGIyYjU3IiwiY2F0IjoxNTg5Mzc3Mzk0LCJleHAiOjE1ODkzNzc5OTQsImlhdCI6MTU4OTM3NzM5NCwiaXNzIjoiZmVhdGhlci5pZCIsImp0aSI6IlVDc3pybnFTeGhzNkZmeDUwdFp6ZHVwTmpsWmZQM1VrZzI3VUZvVHhReVlwa0hZN2VtMFZndEtSTDNQempReXpia3JoNGVONDl0WlRTS1dJaVowN05UQlJoSHY1Y25JeXNPSzciLCJyYXQiOm51bGwsInNlcyI6IlNFU18xMDgzNmNiNi05OTRkLTQwZjYtOTUwYy0zNjE3YmUxN2I3YzMiLCJzdWIiOiJVU1JfYTY4NzViMzQtNDZlYS00MjlkLTg1OGMtM2FhNmEzNDNiNTM0IiwidHlwIjoiYXV0aGVudGljYXRlZCJ9.wgXjg4eY6ziujbGpOuwFyNB9hQrQSFd98Ey4gMhVarZK3OmdXbB0QqDahg1ON6Ebzr_oydjTyk1yD-eJ-5Rf5YwIvl7tC9fTPDkH2rYSIH6qfi0a5k-8-Km8E4x7TY4YPybdMmA4ycJUXvyPEl7N2awHb1YduCpDptUR9A2y_ASzyK4Lw01EdazEjho0OW2sJ7BjInirRbLuK1dKvrUicI8Sj-glr9WRlD1XF0zBeOTcwIa7sMieBrkCUtzPb1QWWTXbExmtGyDr0lyGX_dXdZGO_Q53PRI7m01HxNzrCf1GF_zXoKogg6iQnpbXopSTp51hwe5m-QYBPd0IT2YTsw`,

      missingKeyId: `eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJQUkpfY2RiY2M5ODYtYWU2Ni00NjY2LWI5NDYtMTgyNmNmMGIyYjU3IiwiY2F0IjoxNTg5Mzg0ODk0LCJleHAiOjE1ODkzODU0OTQsImlhdCI6MTU4OTM4NDg5NCwiaXNzIjoiZmVhdGhlci5pZCIsImp0aSI6InBPUk1WQ29kcXZjVTVzbENkdUNiRUpsZ2o3SDhuVkJXQ0JoUWxDd0dvU2p1UXB5WHdneHJDUVVGNjdFZ0dNR0wzM20zQlpISmJ3eVZwemVtN1VjQVcyakUzdW9iU1V6eXZBRlMiLCJyYXQiOm51bGwsInNlcyI6IlNFU180OGExMjBlMS01YjlmLTQ1M2QtOGY4NC03OTNiYmE2M2YyZTgiLCJzdWIiOiJVU1JfYTY4NzViMzQtNDZlYS00MjlkLTg1OGMtM2FhNmEzNDNiNTM0IiwidHlwIjoiYXV0aGVudGljYXRlZCJ9.F4Qnba4SaCGWKFL_3ZPX1o6j-durl4wNi22l5SxjDlXJ7yHDZfus6I0AgA_ZGGTA82wki_sOroL8oA4UGlWJhFnWPAoNiEqw7gjkUaS82lXPJ0DlPhAW5lcABz5W0AL7DzT1YB6kgyCt-cPzbLZECE2l6rLvh4yhvgZ_s1RIMsKZcqZYHkZWGMhJPwgx22T3RzoLymA41JQVr0wrsz8LQfy5nKeDHg51RLk1rZB63n_hXgOFbdjN7a6Dv4Oskhev4dZdSTdCYDLj1fBBHoNT08m02qwKNRuRJ8ePXndf3Lib52m4OQAlvhWf2wKhHGc91PaTpKbRY6GqgK9VXYjWEQ`,

      invalidIssuer: `eyJhbGciOiJSUzI1NiIsImtpZCI6IjAiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJQUkpfY2RiY2M5ODYtYWU2Ni00NjY2LWI5NDYtMTgyNmNmMGIyYjU3IiwiY2F0IjoxNTg5Mzg0Mzc3LCJleHAiOjE1ODkzODQ5NzcsImlhdCI6MTU4OTM4NDM3NywiaXNzIjoiZm9vIiwianRpIjoiZmhyMDJYdWZaMW9sV2gxZWZValNTam9Jd2lyVnNKNTU0WmRUWVBVdUtmSmpIUG9zTHJzdVhsaUtTYU1sUUxlN2N6REFzOTIzaWVIT0M4RmhqcnhzODdIRXdQNXVoWUgwRG1IOSIsInJhdCI6bnVsbCwic2VzIjoiU0VTX2YzZTFlZjZlLTI1OWUtNDNmYy1iNzRhLTEyMjlmM2ZmMzk3MCIsInN1YiI6IlVTUl9hNjg3NWIzNC00NmVhLTQyOWQtODU4Yy0zYWE2YTM0M2I1MzQiLCJ0eXAiOiJhdXRoZW50aWNhdGVkIn0.aaWgoDEkWFXLmK2cr-MCacosr9jhqWycumPyCYUV0AUNe_Vw4Ll-eB980yIHlaeCNhOlWmxMClFrsQ1foLcOmFeWT_SQk66OyvQD5b3JElVF6BkmspuO856BaAegTNsyWoAKPdjOodHp5ibQ7C8vGagYnck7nkGSIAzjFOIW5shVYjlgb80If78WIuD5dmeCm1LP2CKKFagEtHsP24Eib3-P35XzBScTOWp828erNEn_XkZSa6RZNE_2FBklGAxrxq4EfW-NglbvDWbgEk4cntoXDUwt_Rqg_k8mYOJPn6YnbFGfVnaB2qzZAOB7WFsJ_-Hl-wm_88_zLvIOXbUxDA`,

      invalidTokenId: `eyJhbGciOiJSUzI1NiIsImtpZCI6IjAiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJQUkpfY2RiY2M5ODYtYWU2Ni00NjY2LWI5NDYtMTgyNmNmMGIyYjU3IiwiY2F0IjoxNTg5Mzg0NTcwLCJleHAiOjE1ODkzODUxNzAsImlhdCI6MTU4OTM4NDU3MCwiaXNzIjoiZmVhdGhlci5pZCIsImp0aSI6ImZvbyIsInJhdCI6bnVsbCwic2VzIjoiU0VTX2E0MjM3ZDFkLTkxYzUtNDM2MS1iYmQyLTE2MDJhMTNiYjMzYSIsInN1YiI6IlVTUl9hNjg3NWIzNC00NmVhLTQyOWQtODU4Yy0zYWE2YTM0M2I1MzQiLCJ0eXAiOiJhdXRoZW50aWNhdGVkIn0.GuLqfYnSOgFe7Vq5Ys5Uv3JlB-wTMi7dIX6moZx8XF0Lw6VB5LaLFepcow3OXRC5wTwEC6T5lCgemD1n8e8aYVWtJdY9eyCuPrz18tUZF93fwazFuj7O5TaSFSNmVq_43LQXfQ9EVKh4kvOBJT1LIWHS4TAFkThS1amHv1RbDoOmBoHMvHanfTlY-2N2xB_cZrJSRbq1oNAtDXuYBr76CboT_z4aNx79KtFRW73hloP4DyhFhx-SeXT3e9_-RG6DU5apHDLSqpk4GyPAKoWMIySaWVdmb-t42gRyWO3BEmrm-pNSxCRClhewDRevTr2RgVR9tEjP18D9RcDF15BEyw`,

      invalidSubject: `eyJhbGciOiJSUzI1NiIsImtpZCI6IjAiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJQUkpfY2RiY2M5ODYtYWU2Ni00NjY2LWI5NDYtMTgyNmNmMGIyYjU3IiwiY2F0IjoxNTg5Mzg0NzIxLCJleHAiOjE1ODkzODUzMjEsImlhdCI6MTU4OTM4NDcyMSwiaXNzIjoiZmVhdGhlci5pZCIsImp0aSI6IjBrcFZBb0pNTDVSSkRPUzZEMXJxVVZUOEI1b2k4OXhON214R21TZERsYUxCWUc3VmxvOU1uYnZpcmVaV1BJSGNrM1RSeFFJUDF4MFlHVmhhTENncFJqSWsxS1JNbTVRRUp1WWEiLCJyYXQiOm51bGwsInNlcyI6IlNFU183NGQ2YWQ0NC04MzAxLTQxZTQtOGRjNC05MzNkOTcwM2NlNzkiLCJzdWIiOiJmb28iLCJ0eXAiOiJhdXRoZW50aWNhdGVkIn0.MWB7wxza-QFwGAdGYW-FSRrgDgQ8gDoGluCUNfKTNeAn92tontQ-AFjvw_9CiptORVSeAYgLJ8pgonYqi7-16PV6BN6opDkHxllCzMRgbtxvJrGLJjURPqoUU-9YIeCJxB1nOXiildqQwSU9mV72lYolursmym8VEnLp1joaAbAZdbof2QkoHu8mi5aEnLErnSN_2eOx6R8HUdkpfIDa2_1vBQ0s5SDAqmTP2ILjuwRcrSeQe7pDKrZJpgTFb1WSO4Tx7ZMTg1OO-75Olb3mAs5t-N7YY78LzXKCRXuhIp2J0PhtGjq8Y2nQhL4vqBQ5FOXeWurnAV3r0cmMqFpizQ`,

      invalidAudience: `eyJhbGciOiJSUzI1NiIsImtpZCI6IjAiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJmb28iLCJjYXQiOjE1ODkzODUxMTUsImV4cCI6MTU4OTM4NTcxNSwiaWF0IjoxNTg5Mzg1MTE1LCJpc3MiOiJmZWF0aGVyLmlkIiwianRpIjoiZ0g2RUQ2OVhjUFFpc3ZVTnd6Qm1wRmMwSWFSMW9neU13S083NHpQN1hyRHdaa0Fac3pZOFI1QmZ5bllmNGNhWG8zbU1OSnpCRWJ5Mk1CSUlyOE9mV2ZSUkNOek1yWVRPZ0dTWiIsInJhdCI6bnVsbCwic2VzIjoiU0VTXzc3NjM4YmI2LTY1YjYtNDEwNC1hNTQyLTc2ZDRjNWE4MmMxOSIsInN1YiI6IlVTUl9hNjg3NWIzNC00NmVhLTQyOWQtODU4Yy0zYWE2YTM0M2I1MzQiLCJ0eXAiOiJhdXRoZW50aWNhdGVkIn0.ZzueiC6fTJF5zjrmlQh4t3AHylS8DARxeGHZEOpKPIIy6RdT0oD3WmINb1Eu5DEX7PkQs2jpS3cAXQBZxqutUjkaf6ZI0pfzU72Tp1Yu5rtCw8cucWpCt9sRvFrCxSuIwq2yM04plRtB8D040PTGJpSf2Gojf4O6EhsxTktjYCjqotdrpmLj2rfvl7Jj-MAv343mNa-C5id03V5Cb0GOE7EIkSeuDn3_QRX6e11BacMmKChxMzQlivpIZ7htOGOM4IZjWojurF4aFZuUI07YzXhjVWKiaHED91KSX1fY4M0qsvr2f-6f-JuFYzuv5zku2CLO7AY6AgZ7VGiYB3pOlw`,

      invalidSessionId: `eyJhbGciOiJSUzI1NiIsImtpZCI6IjAiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJQUkpfY2RiY2M5ODYtYWU2Ni00NjY2LWI5NDYtMTgyNmNmMGIyYjU3IiwiY2F0IjoxNTg5Mzg1MjE1LCJleHAiOjE1ODkzODU4MTUsImlhdCI6MTU4OTM4NTIxNSwiaXNzIjoiZmVhdGhlci5pZCIsImp0aSI6Im9JaE9oaXJMbVZoRzdQOFhJRHZMa2NVSExxMUhsOVNTOEtLQXpCdzIyQmtDZEdrZmNLTHNodmpMTkVPMWxZY2JmRWtQakl0QURtN2FxTWhxTThXT0JHYmhGNnFkSTVkcTkwdnMiLCJyYXQiOm51bGwsInNlcyI6ImZvbyIsInN1YiI6IlVTUl9hNjg3NWIzNC00NmVhLTQyOWQtODU4Yy0zYWE2YTM0M2I1MzQiLCJ0eXAiOiJhdXRoZW50aWNhdGVkIn0.lxTKv8ty3OdupmqTwSKLYDH3bTwUcDSbHmzKh25jDs9qNNzZzOb27ekY1JEzrOZc1zcQjUh1I-lyAfnwNQeL7JmM2L-2dCGArivGoeB9lS-272uovy0eFZMrFsHjbiaQFHDxoiUDiQg5_kShaes2C8nNjHMOK0qOSPkhK9JTeEkgWYcItt7RK1TFHDUoJtoQELLJmOJhk47rgUnQn-kArR4ITy6rPGbJWUmsko2L1Z4kN1BuNCUpHf6D7KJQ51u7BuqR-_X64a0nF5fp1Q5GItr5YgE2Tr4pm2KumdCUOnHkBbzZ6_bR31DgLoI5AIM4wByxVHVovIlGsFqKtnaC5A`,

      invalidType: `eyJhbGciOiJSUzI1NiIsImtpZCI6IjAiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJQUkpfY2RiY2M5ODYtYWU2Ni00NjY2LWI5NDYtMTgyNmNmMGIyYjU3IiwiY2F0IjoxNTg5Mzg1NDU5LCJleHAiOjE1ODkzODYwNTksImlhdCI6MTU4OTM4NTQ1OSwiaXNzIjoiZmVhdGhlci5pZCIsImp0aSI6Imc2QUV0Tnd5NmRyY3BKSDZKZ0NZNTdyQ0IzZ2dmM3FZZXBsZndFcmNBSkROakFnYUk2VG5DZ2ZkZWlFYW1Ha0dseEFJdk90OGlTd2V2dXJWN0lxWFR5ZHVqSHVaem84ejBldFciLCJyYXQiOm51bGwsInNlcyI6IlNFU19jYjA5NmYyZS0wNTE5LTRjMjItYmFhNC1iNTU4NTM1YjUwNWUiLCJzdWIiOiJVU1JfYTY4NzViMzQtNDZlYS00MjlkLTg1OGMtM2FhNmEzNDNiNTM0IiwidHlwIjoiZm9vIn0.MyIIkcL1Cvug5_-B8jLOAMhFuk0kAuReQ4ueeolYWZNcn_hW8kocCn7GCNdGDZIPFv272-ioKNP4wVKjkN55D9dLN3ySV8B4j-dX9b3KfNZ0jaQk6HaHUbRZm-YUF0NXNe8YaikbYVLGouLHakQxd6hKvY4QBy0lfOuIe4vJ3YwNOfFD-vwv0eDp_CLfHUyFIScZ2GSdoOZpepnZ8qLznQS81wpR_d1lLWxmcgYnqeZzCV7GCAxV34j3F7_8IgEt8LkcR-PDMTTN-M6JOKRMIwFIiDPEeOrTmOLXJr3IYOt6KTeGtPqjOE8A7nN8yOEgXxUcI17CgNFvTdhc6tIglQ`,

      invalidIssueAt: `eyJhbGciOiJSUzI1NiIsImtpZCI6IjAiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJQUkpfY2RiY2M5ODYtYWU2Ni00NjY2LWI5NDYtMTgyNmNmMGIyYjU3IiwiY2F0IjoxNTg5Mzg1NjQ5LCJleHAiOjE1ODkzODYyNDksImlhdCI6ImZvbyIsImlzcyI6ImZlYXRoZXIuaWQiLCJqdGkiOiI1TkRjaWV2ODZaWHZGeGZoVmNtZmh6bTFEc1VZbm1MMVZFNWh3bkJQbDA3QVlKYkx3VDV0ZEdBdnhOcTU3Q0wyVFZHb1JHSnFtR0ttSXdLVEltbmw5aExUU3h2MDVBSnBZckN0IiwicmF0IjpudWxsLCJzZXMiOiJTRVNfZGEwM2NhMDctNzliYi00YmI5LTg3MjQtMTcwNDU0ZTY5ZGJjIiwic3ViIjoiVVNSX2E2ODc1YjM0LTQ2ZWEtNDI5ZC04NThjLTNhYTZhMzQzYjUzNCIsInR5cCI6ImF1dGhlbnRpY2F0ZWQifQ.unXH0fkKW1HkCH5HTL4bDiO3O1HXQbSlvBla8aprCOJZ-O9nGVr1af7mY1v03oi418Gw4aZ299-I_qW6LRc4UjhWvXXMGfOAinMcSSnwcgBHA6eO3yqlbAO7FLU1pPuD5blTZRu86KCelLHwdiP5PIzmMGQyafMvm7K9AFGXQ-6SW30bFoKyoN3LCDWtUSa-tzngzmZv9eAygEPoKpxaN4SV1tNedXwY8-Q8VOVkZuHFgqtzUKUiiemhVyEh-K0hB8CPbwL3ryYHRHIJEOVgFs7CLnFVsoUD8PeuT1SgkamqNEkqzK0w2rkUmazqwvVQDu-d6XXbFabbbTiIUiwR3w`,

      invalidCreatedAt: `eyJhbGciOiJSUzI1NiIsImtpZCI6IjAiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJQUkpfY2RiY2M5ODYtYWU2Ni00NjY2LWI5NDYtMTgyNmNmMGIyYjU3IiwiY2F0IjoiZm9vIiwiZXhwIjoxNTg5Mzg2MzQzLCJpYXQiOjE1ODkzODU3NDMsImlzcyI6ImZlYXRoZXIuaWQiLCJqdGkiOiJtOWxBYWs4UXFTVmwxaHpjaTBQWnExWjduaFVFS2UxMElQUWlBSEpWaG1MYVB3cTVqcmg4NDlJb3JFb09jZnN6eFM1WU9XdVlkOXFnQzV4ZE9TaE5hcUtWb0locm1kR3pKZmMxIiwicmF0IjpudWxsLCJzZXMiOiJTRVNfNTY0MzlmODgtZTExOS00MDYzLWJlMTQtYzk0NTE3OTZhM2NhIiwic3ViIjoiVVNSX2E2ODc1YjM0LTQ2ZWEtNDI5ZC04NThjLTNhYTZhMzQzYjUzNCIsInR5cCI6ImF1dGhlbnRpY2F0ZWQifQ.J93P2kFKvnUx6QFvONyvZqsiAOs4cZSE38may0ssQ_zyZXgc2yBBgocZOOymXjQFJu5DmXODh_zR24wZOR8hVSq3ROsZZiUPeFfd5pUKzigbx0x52lvCaHWThCWj8OIxwd9GUSwT6Re_IJsEmYXAU25dBdQ5Dgvt9dZR6UBS8KVTUGvsQUDTYJoVfgC4iQvGPRUbKqaja9IkkDaT8qhOYl0-2s7LR0NKkc5iDMnKFi5IauZFJfiiC__Sb_KrHOF4_ZvnL4Z9a_x8Dvt1VX5qX16Hv3nB7ZNGPoBNEsM0I7VyLUvvl6n9S4m5Ynvfb9q5Z-CzFXO5qmtTBqNvRaLMhA`,

      invalidExpiresAt: `eyJhbGciOiJSUzI1NiIsImtpZCI6IjAiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJQUkpfY2RiY2M5ODYtYWU2Ni00NjY2LWI5NDYtMTgyNmNmMGIyYjU3IiwiY2F0IjoxNTg5Mzg1ODQ4LCJleHAiOiJmb28iLCJpYXQiOjE1ODkzODU4NDgsImlzcyI6ImZlYXRoZXIuaWQiLCJqdGkiOiJTeUFmczBlM0lnWWhFVnB1eUdHZWlCMlJGNHI4bkIzemludjlOUW5JUVdPeVpGTUpBTVBjTmhVbU41N2J6dFU3SUdzS2xWdElEZHRmRHBCV2RKTExzUXg4YmtNQmZNZmRSYUNDIiwicmF0IjpudWxsLCJzZXMiOiJTRVNfOTQ2NmVhYWQtYTY0YS00MGE0LTk2YzktZjZhMTlhZGYxYzcyIiwic3ViIjoiVVNSX2E2ODc1YjM0LTQ2ZWEtNDI5ZC04NThjLTNhYTZhMzQzYjUzNCIsInR5cCI6ImF1dGhlbnRpY2F0ZWQifQ.Cekvy-Liu0xYJfirQNMY4upHzOybqmkmWrisXofiIeNbgp2y-_EvrlybsJctroOz9MGhldqPJgoddl3CZseHcvWc3u_vVJDdCoYFsVIMzbJr3hCBmPnHOncLmQy-_Mr-Z5vg4x6r3hgbwn_pWM2iBIPKAccIQzS85vJF4QZnOCgyqn9KfOliyCQOtRIUl4UFZg4gcT7tX4ehhDLPc0uJZTuM0voqznZ1K_txsZRxlXBm5iAaL7bVPgI1dX6qgi5AoGew2B2ghZjxly3RjfaxGctqlXRiU42U_2U9oJDyyWSvCtF0Vjv2xisNwBINcsYDe3aBBH0VZrdh6IRYMwvHlA`
    };
  },

  getPublicKeyNock: function() {
    return nock("http://localhost:8080", {
      reqHeaders: {
        Authorization: "Basic dGVzdF9sYUNaR1lmYURSZU5td2tsWnNmSXJUc0ZhNW5WaDk6",
        "Content-Type": "application/x-www-form-urlencoded"
      }
    })
      .get("/v1/publicKeys/0", {})
      .times(1)
      .reply(200, testUtils.getFakePublicKey());
  },

  /**
   *
   */
  getFakePublicKey: function() {
    const pem = `-----BEGIN RSA PUBLIC KEY-----
MIIBCgKCAQEAwovomIOamL39k/Q7OfSxRf7ipn0kuQMLfEY0UWHcwq7ubKfjs368
wMcAa7vhlHamZnrONMTtZUNStbhrMBVlzGcSkhSrOENKg+g6KG29WD5VhupKmSGt
hDjQRlx2nvgZSSVdjx8S+BDArPpIWMviViswjRCucWdqFHR6av0v/bvMRYO3qRXK
pGn+LuiDlCi9sgiK72Ayt9unTjodyugchx6Y+RyboKOWZmiLFWRdkMZkvBaxxgaT
S/y1TneJR9eg5EPxh0YQYYEPT3/CYgaw34s/HtqbILWcr4VSG1lrKDQXOneYL+xj
svTcv2z81qX1WN+qhGasUw/dEwjYmbidNwIDAQAB
-----END RSA PUBLIC KEY-----
`;
    return {
      id: "0",
      object: "publicKey",
      pem: pem
    };
  }
};

module.exports = testUtils;
